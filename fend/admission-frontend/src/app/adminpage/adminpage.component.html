<div class="admin-wrapper">
  <div class="admin-glass-container">

    <!-- Logout Icon -->
    <div class="logout-icon" title="Logout" (click)="logout()">
      <i class="bi bi-box-arrow-right"></i>
    </div>

    <h2 class="admin-title">📋 Registered Students</h2>

    <div class="admin-actions">
      <button class="btn btn-download" (click)="downloadAsExcel()">
        ⬇️ Download as Excel
      </button>
    </div>

    <div *ngIf="students.length > 0; else noData">
      <div class="table-wrapper">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>First</th>
              <th>Last</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Gender</th>
              <th>DOB</th>
              <th>Address</th>
              <th>Course</th>
              <th>Year</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let student of students">
              <td>{{ student.firstName }}</td>
              <td>{{ student.lastName }}</td>
              <td>{{ student.email }}</td>
              <td>{{ student.phone }}</td>
              <td>{{ student.gender }}</td>
              <td>{{ student.dob }}</td>
              <td>{{ student.address }}</td>
              <td>{{ student.course || 'N/A' }}</td>
              <td>{{ student.year || 'N/A' }}</td>
              <td class="action-column">
                <i class="bi bi-pencil-square edit-icon" (click)="editStudent(student.email)" title="Edit"></i>
                <i class="bi bi-trash-fill delete-icon" (click)="deleteStudent(student.email)" title="Delete"></i>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <ng-template #noData>
      <div class="no-data-message">
        <p>No students found.</p>
      </div>
    </ng-template>
  </div>
</div>
